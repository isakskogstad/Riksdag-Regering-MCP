import{L as e,a1 as t,aN as a,aQ as r,Q as i}from"./index-Dvj5Fnvj.js";const o=(o,s)=>{const{toast:n}=t(),d=a(),{data:c,isLoading:f}=e({queryKey:["favorite",o,s],queryFn:async()=>{const{data:e}=await i.auth.getSession();if(!e.session)return!1;const{data:t,error:a}=await i.from("favorites").select("id").eq("table_name",o).eq("document_id",s).single();if(a&&"PGRST116"!==a.code)throw a;return!!t}}),u=r({mutationFn:async()=>{const{data:e}=await i.auth.getSession();if(!e.session)throw new Error("Du måste vara inloggad");if(c){const{error:e}=await i.from("favorites").delete().eq("table_name",o).eq("document_id",s);if(e)throw e}else{const{error:e}=await i.from("favorites").insert({table_name:o,document_id:s});if(e)throw e}},onSuccess:()=>{d.invalidateQueries({queryKey:["favorite",o,s]}),n({title:c?"Borttagen från favoriter":"Tillagd i favoriter"})},onError:e=>{n({title:"Fel",description:e.message,variant:"destructive"})}});return{isFavorite:c,isLoading:f,toggleFavorite:u.mutate}},s=()=>e({queryKey:["all-favorites"],queryFn:async()=>{const{data:e}=await i.auth.getSession();if(!e.session)return[];const{data:t,error:a}=await i.from("favorites").select("*").order("created_at",{ascending:!1});if(a)throw a;return t}});export{o as i,s};
