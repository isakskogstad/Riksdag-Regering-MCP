import{u as e,b as t,c as a}from"./query-vendor-ow7rXqf0.js";import{u as r,s as o}from"./index-DLYd5yL7.js";const i=(i,s)=>{const{toast:n}=r(),d=t(),{data:u,isLoading:c}=e({queryKey:["favorite",i,s],queryFn:async()=>{const{data:e}=await o.auth.getSession();if(!e.session)return!1;const{data:t,error:a}=await o.from("favorites").select("id").eq("table_name",i).eq("document_id",s).single();if(a&&"PGRST116"!==a.code)throw a;return!!t}}),f=a({mutationFn:async()=>{const{data:e}=await o.auth.getSession();if(!e.session)throw new Error("Du måste vara inloggad");if(u){const{error:e}=await o.from("favorites").delete().eq("table_name",i).eq("document_id",s);if(e)throw e}else{const{error:e}=await o.from("favorites").insert({table_name:i,document_id:s});if(e)throw e}},onSuccess:()=>{d.invalidateQueries({queryKey:["favorite",i,s]}),n({title:u?"Borttagen från favoriter":"Tillagd i favoriter"})},onError:e=>{n({title:"Fel",description:e.message,variant:"destructive"})}});return{isFavorite:u,isLoading:c,toggleFavorite:f.mutate}},s=()=>e({queryKey:["all-favorites"],queryFn:async()=>{const{data:e}=await o.auth.getSession();if(!e.session)return[];const{data:t,error:a}=await o.from("favorites").select("*").order("created_at",{ascending:!1});if(a)throw a;return t}});export{i as a,s as u};
